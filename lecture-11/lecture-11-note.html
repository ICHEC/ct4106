
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Quadratic unconstrained binary optimization (QUBO) &#8212; Lecture Notes for CT4106</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/drawio.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css?v=fb429c44" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lecture-11/lecture-11-note';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Lecture Notes for CT4106 - Home"/>
    <img src="../_static/logo.png" class="logo__image only-dark pst-js-only" alt="Lecture Notes for CT4106 - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    CT4106 Lectures Overview
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../lecture-01/demystifying-qc.html">Lecture 1: Demystifying Quantum Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture-02/integrating-cc-and-qc.html">Lecture 2: Integrating Classical and Quantum Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture-03/from-bits-to-qubits.html">Lecture 3: From Bits to Qubits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture-04/math-for-qc.html">Lecture 4: Mathematical framework for Quantum Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture-05/intro-to-quantum-info.html">Lecture 5: Introduction to Quantum Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture-06/realizing-qc-systems.html">Lecture 6: Realizing Quantum Computing Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture-07/qc-hardwares.html">Lecture 7: Hardwares for Quantum Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture-08/accessing-qc-systems.html">Lecture 8a: Accessing Quantum Computing Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture-08/landscape-of-sdks-tools.html">Lecture 8b: Landscape of Quantum SDK’s and Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture-09/cloud-qc.html">Lecture 9: Heterogeneous Quantum Computing on AWS with Amazon Braket</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture-10/quantum-algorithms-1.html">Lecture 10: Early Quantum Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="quantum-algorithms-2.html">Lecture 11: NISQ Quantum Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture-12/quantum-activity-in-ichec.html">Lecture 12: Quantum Activities in ICHEC</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/lecture-11/lecture-11-note.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Quadratic unconstrained binary optimization (QUBO)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1">Example 1</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="quadratic-unconstrained-binary-optimization-qubo">
<h1>Quadratic unconstrained binary optimization (QUBO)<a class="headerlink" href="#quadratic-unconstrained-binary-optimization-qubo" title="Link to this heading">#</a></h1>
<section id="example-1">
<h2>Example 1<a class="headerlink" href="#example-1" title="Link to this heading">#</a></h2>
<p>Consider a set of N positive integers (though one doesn’t need to) <span class="math notranslate nohighlight">\(U = \{n_1, n_2, n_3, \dots, n_N\}\)</span>, and imagine the goal is to construct two disjoint subsets of this, called A and B, such that <span class="math notranslate nohighlight">\(A\cup B=U\)</span> and <span class="math notranslate nohighlight">\(A\cap B=\empty\)</span>, such that the sum of the numbers in each subset is equal or as close to each other as possible.</p>
<p>Formally, the sets A and B are to be constructed so that</p>
<div class="math notranslate nohighlight">
\[f(\{n_i\}) = (S_A - S_B)^2~~\text{where}\]</div>
<div class="math notranslate nohighlight">
\[S_A = \sum_{i\in A} n_i, \quad S_B = \sum_{i\in B}n_i\]</div>
<p>is minimum. This is a <code class="docutils literal notranslate"><span class="pre">cost</span> <span class="pre">function</span></code> that has to be minimized.</p>
<p>What we do is, assign to each number <span class="math notranslate nohighlight">\(n_i\)</span> a binary variable <span class="math notranslate nohighlight">\(x_i\)</span>, such that <span class="math notranslate nohighlight">\(x_i = 1\)</span> if <span class="math notranslate nohighlight">\(n_i\in A\)</span> or otherwise <span class="math notranslate nohighlight">\(x_i = 0\)</span> if <span class="math notranslate nohighlight">\(n_i \in B\)</span>.</p>
<p>Now we can write the partial sum as
$<span class="math notranslate nohighlight">\(
S_A = \sum_{i\in U} n_i x_i \\S_B = \sum_{i\in U}n_i (1-x_i)
\)</span>$</p>
<p>The cost function can now be written as</p>
<div class="amsmath math notranslate nohighlight" id="equation-9c74ce25-66d0-4be6-b7e5-7bbc6eee35e0">
<span class="eqno">()<a class="headerlink" href="#equation-9c74ce25-66d0-4be6-b7e5-7bbc6eee35e0" title="Permalink to this equation">#</a></span>\[\begin{align}
f(\{n_i\}) &amp;= (S_A - S_B)^2 = S_A^2 + S_B^2 - 2S_A S_B\\
&amp;= (\sum_{i\in U} n_i x_i)^2 + (\sum_{i\in U}n_i (1-x_i))^2 - 2 (\sum_{i\in U} n_i x_i)\sum_{j\in U}n_j (1-x_j)\\
&amp;= \sum_{ij\in U}\left[
    n_i n_j x_i x_j + n_i n_j (1-x_i)(1-x_j) - 2 n_i n_j x_i (1-x_j)
    \right]\\
    &amp;= \sum_{ij\in U} n_i n_j (x_i x_j + 1 - x_i - x_j + x_i x_j - 2x_i + 2 x_i x_j)\\
    &amp;= 4\sum_{ij\in U} n_i n_j x_i x_j - 4\sum_{ij\in U}(n_i n_j x_i) + S^2\\
    &amp;= 4\sum_{ij\in U} n_i n_j x_i x_j - 4S\sum_{i\in U}n_i x_i + S^2 
\end{align}\]</div>
<p>Where <span class="math notranslate nohighlight">\(S_U = \sum_{i\in U} n_i\)</span> is the sum of all the numbers in the set U. Thus we need to minimize the <code class="docutils literal notranslate"><span class="pre">f</span></code> over the discrete space of vector <strong>x</strong> <span class="math notranslate nohighlight">\( = \{x_1, x_2, \dots, x_N\}\)</span>. Note that the cost function <code class="docutils literal notranslate"><span class="pre">f</span></code> is quadratic in <span class="math notranslate nohighlight">\(x_i\)</span></p>
<div class="math notranslate nohighlight">
\[
f(x) = 4\sum_{ij\in U} n_i n_j x_i x_j - 4S\sum_{i\in U}n_i x_i + S^2 
\]</div>
<p>The cost function can be expressed in matrix form as</p>
<div class="math notranslate nohighlight">
\[
f(x) = 4 x^{T}Qx + V^{T}x + S^2
\]</div>
<p>where <span class="math notranslate nohighlight">\(Q_{ij} = 4n_i n_j\)</span> and <span class="math notranslate nohighlight">\(V_i = -4S n_i\)</span></p>
<div class="amsmath math notranslate nohighlight" id="equation-05bcdc90-b81d-4ffc-be5b-79b44e098dc1">
<span class="eqno">()<a class="headerlink" href="#equation-05bcdc90-b81d-4ffc-be5b-79b44e098dc1" title="Permalink to this equation">#</a></span>\[\begin{align}
f(\{n_i\}) = 4\sum_{ij\in U} n_i n_j x_i x_j - 4S\sum_{i\in U}n_i x_i + S^2
\\
= 8\sum_{i&gt;j} n_i n_j x_i x_j
+4\sum_{i}(n_i^2 - S n_i) x_i + S^2 
\end{align}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">class</span> <span class="nc">qubo</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ni</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ni</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">ni</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Q</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ni</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ni</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">S</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ni</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">V</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">S</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ni</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ni</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">x</span> <span class="o">@</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Q</span> <span class="o">@</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">V</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="o">**</span><span class="mi">2</span>
        <span class="k">return</span> <span class="n">f</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">itertools</span>

<span class="c1"># a = np.random.random(6) * 10 + 1</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">qfunc</span> <span class="o">=</span> <span class="n">qubo</span><span class="p">(</span><span class="n">ni</span><span class="o">=</span><span class="n">a</span><span class="p">)</span>
<span class="n">a</span> <span class="o">==</span> <span class="n">qfunc</span><span class="o">.</span><span class="n">ni</span><span class="p">,</span><span class="n">a</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qfunc</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">-</span><span class="n">B</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="n">nsize</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">il</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nsize</span><span class="p">)</span>
<span class="n">q_f</span> <span class="o">=</span> <span class="n">qfunc</span>
<span class="n">vecs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dist</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">choose</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nsize</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;separation: (</span><span class="si">{</span><span class="n">choose</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="n">nsize</span><span class="o">-</span><span class="n">choose</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="n">il</span><span class="p">,</span> <span class="n">choose</span><span class="p">):</span>
        <span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromiter</span><span class="p">(((</span><span class="n">i</span> <span class="ow">in</span> <span class="n">ii</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">il</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
        <span class="n">fi</span> <span class="o">=</span> <span class="n">q_f</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>
        <span class="n">vecs</span> <span class="o">+=</span> <span class="p">[</span><span class="n">xi</span><span class="p">]</span>
        <span class="n">dist</span> <span class="o">+=</span> <span class="p">[</span><span class="n">fi</span><span class="p">]</span>
        <span class="c1">#print(ii, xi.astype(int))</span>
<span class="n">vecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vecs</span><span class="p">)</span>
<span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 1
separation: (1,5)
separation: (2,4)
separation: (3,3)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#plt.xlim(0,30000)</span>
<span class="n">toprint</span> <span class="o">=</span> <span class="s1">&#39;U=(&#39;</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">toprint</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;f(x)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Degeneracy&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">dd</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">line</span> <span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1">#plt.xlim(0,30000)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">toprint</span> <span class="o">=</span> <span class="s1">&#39;U=(&#39;</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">toprint</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;f(x)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Degeneracy&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;plt&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">itertools</span>

<span class="c1"># a = np.random.random(6) * 10 + 1</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">qfunc</span> <span class="o">=</span> <span class="n">qubo</span><span class="p">(</span><span class="n">ni</span><span class="o">=</span><span class="n">a</span><span class="p">)</span>
<span class="n">a</span> <span class="o">==</span> <span class="n">qfunc</span><span class="o">.</span><span class="n">ni</span><span class="p">,</span><span class="n">a</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qfunc</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">-</span><span class="n">B</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="n">nsize</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">il</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nsize</span><span class="p">)</span>
<span class="n">q_f</span> <span class="o">=</span> <span class="n">qfunc</span>
<span class="n">vecs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dist</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">choose</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nsize</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;separation: (</span><span class="si">{</span><span class="n">choose</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="n">nsize</span><span class="o">-</span><span class="n">choose</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="n">il</span><span class="p">,</span> <span class="n">choose</span><span class="p">):</span>
        <span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromiter</span><span class="p">(((</span><span class="n">i</span> <span class="ow">in</span> <span class="n">ii</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">il</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
        <span class="n">fi</span> <span class="o">=</span> <span class="n">q_f</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>
        <span class="n">vecs</span> <span class="o">+=</span> <span class="p">[</span><span class="n">xi</span><span class="p">]</span>
        <span class="n">dist</span> <span class="o">+=</span> <span class="p">[</span><span class="n">fi</span><span class="p">]</span>
        <span class="c1">#print(ii, xi.astype(int))</span>
<span class="n">vecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vecs</span><span class="p">)</span>
<span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9801 9801
separation: (1,6)
separation: (2,5)
separation: (3,4)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#plt.xlim(0,30000)</span>
<span class="n">toprint</span> <span class="o">=</span> <span class="s1">&#39;U=(&#39;</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">7800</span><span class="p">,</span> <span class="mf">5.4</span><span class="p">,</span> <span class="n">toprint</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;f(x)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Degeneracy&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">dd</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b9a45357136d9051827ee1d673e187b1fcbb9942e0280076aee6b0bfc1934b37.png" src="../_images/b9a45357136d9051827ee1d673e187b1fcbb9942e0280076aee6b0bfc1934b37.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 2, 5, 9, 7, 3, 5</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">((</span><span class="n">A</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">-</span> <span class="n">B</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">qfunc</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dist</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1235520,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span> <span class="c1"># .astype(bool)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">qfunc</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qfunc</span><span class="o">.</span><span class="n">ni</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qfunc</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qfunc</span><span class="o">.</span><span class="n">V</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2 5 9 7 3 5] [0 0 0 1 0 0] 289
[2 5 9 7 3 5]
[[ 16  40  72  56  24  40]
 [ 40 100 180 140  60 100]
 [ 72 180 324 252 108 180]
 [ 56 140 252 196  84 140]
 [ 24  60 108  84  36  60]
 [ 40 100 180 140  60 100]]
[ -248  -620 -1116  -868  -372  -620]
</pre></div>
</div>
</div>
</div>
<p>If <span class="math notranslate nohighlight">\(N\)</span> is the number of elements in <span class="math notranslate nohighlight">\(U\)</span>, then the number of <span class="math notranslate nohighlight">\(x\)</span> vectors is</p>
<div class="math notranslate nohighlight">
\[
N_{vec} = {}^NC_1 + {}^NC_2 + {}^NC_3 \dots {}^NC_{\frac{N}{2}} = 2^{N-1}
\]</div>
<div class="math notranslate nohighlight">
\[
(x+1)^n = {}^NC_0 + {}^NC_1 x + {}^NC_2 x^2 \dots {}^NC_N x^n
\]</div>
<p><span class="math notranslate nohighlight">\(x=1\)</span></p>
<div class="math notranslate nohighlight">
\[
2^n = {}^NC_0 + {}^NC_1 + {}^NC_2 \dots {}^NC_N
\]</div>
<p><span class="math notranslate nohighlight">\(x = -1 \)</span></p>
<div class="math notranslate nohighlight">
\[
0 = {}^NC_0 - {}^NC_1 + {}^NC_2 \dots + (-1)^N {}^NC_N
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="n">nsize</span> <span class="o">=</span> <span class="mi">21</span>
<span class="n">ni</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">nsize</span><span class="p">)</span>
<span class="c1"># ni = np.array([10, 1, 16, 14, 22, 26, 29, 23, 21, 5, 14, 9, 12, 27, 22, 9, 14, 27, 12, 9, 24])</span>
<span class="c1"># ni[-1] = 1500</span>
<span class="n">il</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nsize</span><span class="p">)</span>
<span class="n">q_f</span> <span class="o">=</span> <span class="n">qubo</span><span class="p">(</span><span class="n">ni</span><span class="o">=</span><span class="n">ni</span><span class="p">)</span>
<span class="n">vecs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dist</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">choose</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nsize</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;separation: (</span><span class="si">{</span><span class="n">choose</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="n">nsize</span><span class="o">-</span><span class="n">choose</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="n">il</span><span class="p">,</span> <span class="n">choose</span><span class="p">):</span>
        <span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromiter</span><span class="p">(((</span><span class="n">i</span> <span class="ow">in</span> <span class="n">ii</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">il</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
        <span class="n">fi</span> <span class="o">=</span> <span class="n">q_f</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>
        <span class="n">vecs</span> <span class="o">+=</span> <span class="p">[</span><span class="n">xi</span><span class="p">]</span>
        <span class="n">dist</span> <span class="o">+=</span> <span class="p">[</span><span class="n">fi</span><span class="p">]</span>
        <span class="c1">#print(ii, xi.astype(int))</span>
<span class="n">vecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vecs</span><span class="p">)</span>
<span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>separation: (1,20)
separation: (2,19)
separation: (3,18)
separation: (4,17)
separation: (5,16)
separation: (6,15)
separation: (7,14)
separation: (8,13)
separation: (9,12)
separation: (10,11)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">toprint</span> <span class="o">=</span> <span class="s1">&#39;U=(&#39;</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ni</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">6</span><span class="p">):</span>
    <span class="n">toprint</span> <span class="o">+=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ni</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">6</span><span class="p">]])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="n">toprint</span> <span class="o">=</span> <span class="n">toprint</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">toprint</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">20000</span><span class="p">,</span> <span class="mi">150000</span><span class="p">,</span> <span class="n">toprint</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;f(x)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Degeneracy&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">60000</span><span class="p">)</span>
<span class="n">dd</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>U=(10, 1, 16, 14, 22, 26
29, 23, 21, 5, 14, 9
12, 27, 22, 9, 14, 27
12, 9, 24)
</pre></div>
</div>
<img alt="../_images/3f167287b9de248326b4db6b8a9f8b85062fc34feb8b073970206f04e9fac1c8.png" src="../_images/3f167287b9de248326b4db6b8a9f8b85062fc34feb8b073970206f04e9fac1c8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="n">nsize</span> <span class="o">=</span> <span class="mi">21</span>
<span class="c1">#ni = np.random.randint(1, 30, size=nsize)</span>
<span class="n">ni</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1500</span>
<span class="n">il</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nsize</span><span class="p">)</span>
<span class="n">q_f</span> <span class="o">=</span> <span class="n">qubo</span><span class="p">(</span><span class="n">ni</span><span class="o">=</span><span class="n">ni</span><span class="p">)</span>
<span class="n">vecs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dist</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">choose</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nsize</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;separation: (</span><span class="si">{</span><span class="n">choose</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="n">nsize</span><span class="o">-</span><span class="n">choose</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="n">il</span><span class="p">,</span> <span class="n">choose</span><span class="p">):</span>
        <span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromiter</span><span class="p">(((</span><span class="n">i</span> <span class="ow">in</span> <span class="n">ii</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">il</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
        <span class="n">fi</span> <span class="o">=</span> <span class="n">q_f</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>
        <span class="n">vecs</span> <span class="o">+=</span> <span class="p">[</span><span class="n">xi</span><span class="p">]</span>
        <span class="n">dist</span> <span class="o">+=</span> <span class="p">[</span><span class="n">fi</span><span class="p">]</span>
        <span class="c1">#print(ii, xi.astype(int))</span>
<span class="n">vecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vecs</span><span class="p">)</span>
<span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>separation: (1,20)
separation: (2,19)
separation: (3,18)
separation: (4,17)
separation: (5,16)
separation: (6,15)
separation: (7,14)
separation: (8,13)
separation: (9,12)
separation: (10,11)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">toprint</span> <span class="o">=</span> <span class="s1">&#39;U=(&#39;</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ni</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">6</span><span class="p">):</span>
    <span class="n">toprint</span> <span class="o">+=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ni</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">6</span><span class="p">]])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="n">toprint</span> <span class="o">=</span> <span class="n">toprint</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">toprint</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">2.3e6</span><span class="p">,</span> <span class="mi">45000</span><span class="p">,</span> <span class="n">toprint</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;f(x)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Degeneracy&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="c1">#plt.xlim(-1000, 60000)</span>
<span class="n">dd</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>U=(10, 1, 16, 14, 22, 26
29, 23, 21, 5, 14, 9
12, 27, 22, 9, 14, 27
12, 9, 1500)
</pre></div>
</div>
<img alt="../_images/7455d17225e146ede2b061c6b73b81cba7649ecdd0d2e02c0a4697e76addb909.png" src="../_images/7455d17225e146ede2b061c6b73b81cba7649ecdd0d2e02c0a4697e76addb909.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">heuristic_solve</span><span class="p">(</span><span class="n">numlist</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">copy</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">numlist</span><span class="p">)</span>
    <span class="n">list_copy</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">numlist</span><span class="p">))</span>
    <span class="n">list_copy</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">set_AB</span> <span class="o">=</span> <span class="p">([],</span> <span class="p">[])</span>
    <span class="n">ii</span><span class="p">,</span> <span class="n">cc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">list_copy</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">list_copy</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">set_AB</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
        <span class="n">ii</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">ii</span>
        <span class="n">cc</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_copy</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">set_AB</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">list_copy</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>
    <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">cc</span><span class="o">%</span><span class="k">2</span> == 0:
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">list_copy</span>
            <span class="n">set_AB</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
            <span class="n">set_AB</span><span class="p">[</span><span class="mi">1</span><span class="o">-</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">list_copy</span><span class="o">.</span><span class="n">pop</span><span class="p">(),</span> <span class="n">list_copy</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="n">set_AB</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
    <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">set_AB</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">i</span> <span class="ow">in</span> <span class="n">y1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numlist</span><span class="p">])</span>
    <span class="c1"># fix this!</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span>


<span class="n">numlist</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">numlist</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span>
<span class="n">numlist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">heuristic_solve</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">numlist</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">numlist</span><span class="p">),</span> <span class="n">numlist</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y1</span><span class="p">),</span> <span class="n">y1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y2</span><span class="p">),</span> <span class="n">y2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;f_n = &#39;</span><span class="p">,</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">y1</span><span class="p">)</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">(</span><span class="n">y2</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
100 [8, 10, 6, 1, 6, 0, 7, 5, 7, 2, 6, 0, 0, 5, 4, 9, 0, 3, 1, 3, 1, 2, 4, 3, 9, 8, 7, 6, 9, 7, 4, 3, 10, 7, 9, 2, 10, 0, 1, 4, 5, 8, 6, 6, 10, 4, 2, 3, 8, 9, 9, 5, 9, 3, 9, 9, 3, 3, 2, 1, 9, 6, 10, 10, 3, 1, 8, 7, 10, 0, 7, 1, 6, 5, 0, 7, 7, 2, 9, 7, 10, 10, 4, 9, 2, 7, 9, 5, 8, 1, 6, 4, 2, 3, 7, 10, 9, 6, 7, 1]
50 [0, 10, 0, 10, 0, 10, 0, 10, 1, 10, 1, 9, 1, 9, 1, 9, 2, 9, 2, 9, 2, 9, 2, 9, 3, 8, 3, 8, 3, 8, 3, 7, 3, 7, 4, 7, 4, 7, 4, 7, 4, 7, 5, 7, 5, 6, 5, 6, 6, 6]
50 [0, 10, 0, 10, 0, 10, 1, 10, 1, 10, 1, 9, 1, 9, 1, 9, 2, 9, 2, 9, 2, 9, 2, 9, 3, 8, 3, 8, 3, 8, 3, 7, 3, 7, 4, 7, 4, 7, 4, 7, 5, 7, 5, 6, 5, 6, 6, 6, 6, 6]
f_n =  4
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">class</span> <span class="nc">qubo</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Define QUBO function for set partitioning problem.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ni</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ni</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">ni</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ni</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">Q</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ni</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ni</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">S</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ni</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">V</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">S</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ni</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">x</span> <span class="o">@</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Q</span> <span class="o">@</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">V</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="o">**</span><span class="mi">2</span>
        <span class="k">return</span> <span class="n">f</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">qubofunc</span><span class="o">.</span><span class="n">ni</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qubofunc</span><span class="o">.</span><span class="n">Q</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 3  4  5  6  8 12 11 15]
[[ 36  48  60  72  96 144 132 180]
 [ 48  64  80  96 128 192 176 240]
 [ 60  80 100 120 160 240 220 300]
 [ 72  96 120 144 192 288 264 360]
 [ 96 128 160 192 256 384 352 480]
 [144 192 240 288 384 576 528 720]
 [132 176 220 264 352 528 484 660]
 [180 240 300 360 480 720 660 900]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qq</span> <span class="o">=</span> <span class="p">{(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">ising</span><span class="o">.</span><span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ising</span><span class="o">.</span><span class="n">N</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ising</span><span class="o">.</span><span class="n">N</span><span class="p">)}</span>
<span class="n">bb</span> <span class="o">=</span> <span class="n">dimod</span><span class="o">.</span><span class="n">BinaryQuadraticModel</span><span class="p">(</span><span class="n">qq</span><span class="p">,</span> <span class="n">vartype</span><span class="o">=</span><span class="n">dimod</span><span class="o">.</span><span class="n">SPIN</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bb</span><span class="o">.</span><span class="n">quadratic</span><span class="p">)</span>

<span class="n">sampler</span> <span class="o">=</span> <span class="n">dimod</span><span class="o">.</span><span class="n">ExactSolver</span><span class="p">()</span>
<span class="n">sample_set</span> <span class="o">=</span> <span class="n">sampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">bb</span><span class="p">)</span>
<span class="n">sample_set</span> <span class="o">=</span> <span class="n">sample_set</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">sample_set</span><span class="p">)</span>
<span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">sample_set</span><span class="o">.</span><span class="n">samples</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">ising</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)))</span>

<span class="n">sample</span><span class="o">.</span><span class="n">_data</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Section 3.1 The Number Partitioning Problem</span>
<span class="sd">Partition a set of numbers into two subsets such that the subset sums are as close to each other as possible.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">dimod</span>
<span class="kn">import</span> <span class="nn">dwave</span>
<span class="kn">from</span> <span class="nn">dwave.system.samplers</span> <span class="kn">import</span> <span class="n">DWaveSampler</span>
<span class="kn">from</span> <span class="nn">dwave.system.composites</span> <span class="kn">import</span> <span class="n">EmbeddingComposite</span>

<span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;#&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>


    


<span class="c1"># First try to solve using classical computing / programming naively.</span>
<span class="c1"># Sort the list in ascending order and then split it into 2 list based on odd and even index position</span>
<span class="n">numbers_copy</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>
<span class="n">numbers_copy</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="n">list1</span> <span class="o">=</span> <span class="n">numbers_copy</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span>
<span class="n">list2</span> <span class="o">=</span> <span class="n">numbers_copy</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Using classical computing / programming&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;list1: </span><span class="si">{}</span><span class="s2">, sum: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">list1</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">list1</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;list2: </span><span class="si">{}</span><span class="s2">, sum: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">list2</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">list2</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;diff: abs(sum(list1) - sum(list2)) = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">list1</span><span class="p">)</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">(</span><span class="n">list2</span><span class="p">))))</span>

<span class="c1"># Using classical computing / programming</span>
<span class="c1"># list1: [7, 13, 21, 31], sum: 72</span>
<span class="c1"># list2: [10, 17, 25, 42], sum: 94</span>
<span class="c1"># diff: abs(sum(list1) - sum(list2)) = 22</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;#&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">split_numbers_list</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
    <span class="n">list1</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">list2</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">include_in_list</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">key</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">include_in_list</span><span class="p">:</span>
            <span class="n">list1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numbers</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">list2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numbers</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">list1</span><span class="p">,</span> <span class="n">list2</span>


<span class="n">c</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>
<span class="n">c_square</span> <span class="o">=</span> <span class="n">c</span> <span class="o">**</span> <span class="n">c</span>

<span class="n">linear</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">quadratic</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">offset</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">vartype</span> <span class="o">=</span> <span class="n">dimod</span><span class="o">.</span><span class="n">BINARY</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">numbers</span><span class="p">):</span>
    <span class="n">linear</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span> <span class="o">*</span> <span class="p">(</span><span class="n">value</span> <span class="o">-</span> <span class="n">c</span><span class="p">)</span>
<span class="k">for</span> <span class="n">index1</span><span class="p">,</span> <span class="n">value1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">numbers</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">index2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">index1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">numbers</span><span class="p">)):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">value1</span> <span class="o">*</span> <span class="n">numbers</span><span class="p">[</span><span class="n">index2</span><span class="p">]</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">index1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">index2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">quadratic</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">quadratic</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">idx</span><span class="p">))]</span> <span class="o">=</span> <span class="n">value</span>
<span class="c1"># print linear</span>
<span class="c1"># print quadratic</span>

<span class="c1"># Expected Solution</span>
<span class="c1"># x=(0,0,0,1,1,0,0,1), ie list1=[31,42,10]; list2=[25,7,13,17,21]</span>
<span class="c1"># y=-6889</span>

<span class="n">bqm</span> <span class="o">=</span> <span class="n">dimod</span><span class="o">.</span><span class="n">BinaryQuadraticModel</span><span class="p">(</span><span class="n">linear</span><span class="p">,</span> <span class="n">quadratic</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">vartype</span><span class="p">)</span>
<span class="n">sampler</span> <span class="o">=</span> <span class="n">dimod</span><span class="o">.</span><span class="n">ExactSolver</span><span class="p">()</span>
<span class="n">sample_set</span> <span class="o">=</span> <span class="n">sampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">bqm</span><span class="p">)</span>
<span class="n">sample_set</span> <span class="o">=</span> <span class="n">sample_set</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Using ExactSolver()&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sample_set</span><span class="p">)</span>
<span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">sample_set</span><span class="o">.</span><span class="n">samples</span><span class="p">():</span>
    <span class="n">list1</span><span class="p">,</span> <span class="n">list2</span> <span class="o">=</span> <span class="n">split_numbers_list</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">sample</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="s2">&quot;list1: </span><span class="si">{}</span><span class="s2">, sum: </span><span class="si">{}</span><span class="s2">, list2: </span><span class="si">{}</span><span class="s2">, sum: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">list1</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">list1</span><span class="p">),</span> <span class="n">list2</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">list2</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>

<span class="c1"># Print the first 5 results, notice there are multiple solutions that achieve</span>
<span class="c1"># the right answer.</span>
<span class="c1">#</span>
<span class="c1"># Using ExactSolver()</span>
<span class="c1">#    1  2  3  4  5  6  7  8  energy num_oc.</span>
<span class="c1"># 0  0  0  0  1  1  0  0  1 -6889.0       1</span>
<span class="c1"># 1  0  1  1  0  1  0  1  0 -6889.0       1</span>
<span class="c1"># 2  1  1  1  0  0  1  1  0 -6889.0       1</span>
<span class="c1"># 3  1  0  0  1  0  1  0  1 -6889.0       1</span>
<span class="c1"># 4  1  1  0  1  0  0  1  0 -6888.0       1</span>
<span class="c1"># [&#39;BINARY&#39;, 5 rows, 5 samples, 8 variables]</span>
<span class="c1"># list1: [31, 42, 10], sum: 83, list2: [25, 7, 13, 17, 21], sum: 83</span>
<span class="c1"># list1: [7, 13, 42, 21], sum: 83, list2: [25, 31, 17, 10], sum: 83</span>
<span class="c1"># list1: [25, 7, 13, 17, 21], sum: 83, list2: [31, 42, 10], sum: 83</span>
<span class="c1"># list1: [25, 31, 17, 10], sum: 83, list2: [7, 13, 42, 21], sum: 83</span>
<span class="c1"># list1: [25, 7, 31, 21], sum: 84, list2: [13, 42, 17, 10], sum: 82</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;#&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>

<span class="n">sampler</span> <span class="o">=</span> <span class="n">dimod</span><span class="o">.</span><span class="n">SimulatedAnnealingSampler</span><span class="p">()</span>
<span class="n">sample_set</span> <span class="o">=</span> <span class="n">sampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">bqm</span><span class="p">)</span>
<span class="n">sample_set</span> <span class="o">=</span> <span class="n">sample_set</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Using SimulatedAnnlearingSampler()&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sample_set</span><span class="p">)</span>
<span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">sample_set</span><span class="o">.</span><span class="n">samples</span><span class="p">():</span>
    <span class="n">list1</span><span class="p">,</span> <span class="n">list2</span> <span class="o">=</span> <span class="n">split_numbers_list</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">sample</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="s2">&quot;list1: </span><span class="si">{}</span><span class="s2">, sum: </span><span class="si">{}</span><span class="s2">, list2: </span><span class="si">{}</span><span class="s2">, sum: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">list1</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">list1</span><span class="p">),</span> <span class="n">list2</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">list2</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>

<span class="c1"># Using SimulatedAnnlearingSampler()</span>
<span class="c1">#    1  2  3  4  5  6  7  8  energy num_oc.</span>
<span class="c1"># 0  0  0  0  1  1  0  0  1 -6889.0       1</span>
<span class="c1"># 1  1  1  1  0  0  1  1  0 -6889.0       1</span>
<span class="c1"># 2  1  1  0  0  1  0  0  1 -6888.0       1</span>
<span class="c1"># 3  0  0  0  0  1  1  1  0 -6880.0       1</span>
<span class="c1"># 4  0  0  0  0  1  1  1  0 -6880.0       1</span>
<span class="c1"># [&#39;BINARY&#39;, 5 rows, 5 samples, 8 variables]</span>
<span class="c1"># list1: [31, 42, 10], sum: 83, list2: [25, 7, 13, 17, 21], sum: 83</span>
<span class="c1"># list1: [25, 7, 13, 17, 21], sum: 83, list2: [31, 42, 10], sum: 83</span>
<span class="c1"># list1: [25, 7, 42, 10], sum: 84, list2: [13, 31, 17, 21], sum: 82</span>
<span class="c1"># list1: [42, 17, 21], sum: 80, list2: [25, 7, 13, 31, 10], sum: 86</span>
<span class="c1"># list1: [42, 17, 21], sum: 80, list2: [25, 7, 13, 31, 10], sum: 86</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;#&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">sampler = EmbeddingComposite(DWaveSampler())</span>
<span class="sd">sample_set = sampler.sample(bqm, num_reads=10)</span>
<span class="sd">print(&quot;Using DWaveSampler()&quot;)</span>
<span class="sd">print(sample_set)</span>
<span class="sd">for sample in sample_set.samples():</span>
<span class="sd">    list1, list2 = split_numbers_list(numbers, sample)</span>
<span class="sd">    print(</span>
<span class="sd">        &quot;list1: {}, sum: {}, list2: {}, sum: {}&quot;.format(</span>
<span class="sd">            list1, sum(list1), list2, sum(list2)</span>
<span class="sd">        )</span>
<span class="sd">    )</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">class Ising:</span>
<span class="sd">    # Define 1D Ising model</span>
<span class="sd">    def __init__(self, N=10, Jij=None, h=None) -&gt; None:</span>
<span class="sd">        self.Jij = Jij</span>
<span class="sd">        self.h, self.N = h, N</span>
<span class="sd">        self.Q = np.zeros([self.N, self.N])</span>
<span class="sd">        for i in range(self.N-1):</span>
<span class="sd">            self.Q[i, i+1], self.Q[i+1, i] = Jij, Jij</span>
<span class="sd">        self.x = cp.Variable(self.N, boolean=True)</span>
<span class="sd">        self.costfunc = cp.quad_form(self.x, self.Q)#(self.x @ self.Q) @ self.x</span>
<span class="sd">        self.objective = cp.Minimize(self.costfunc)</span>
<span class="sd">        self.problem = cp.Problem(self.objective)</span>
<span class="sd">    def __call__(self, x):</span>
<span class="sd">        pass</span>

<span class="sd">ising = Ising(6, Jij=1.0)</span>
<span class="sd">ising.problem.solve()</span>

<span class="sd">def find_best_partition(lst):</span>
<span class="sd">    n = len(lst)</span>
<span class="sd">    total_sum = sum(lst)</span>
<span class="sd">    target_sum = total_sum / 2</span>
<span class="sd">    # Define the optimization variable</span>
<span class="sd">    x = cp.Variable(n, boolean=True)  # Binary variable representing if an element is in the first partition</span>
<span class="sd">    # Define the objective: minimize the absolute difference between partition sums</span>
<span class="sd">    subset_sum = cp.sum(cp.multiply(x, lst))</span>
<span class="sd">    objective = cp.Minimize(cp.abs(target_sum - subset_sum))</span>
<span class="sd">    # Define the problem</span>
<span class="sd">    problem = cp.Problem(objective)</span>
<span class="sd">    # Solve the problem</span>
<span class="sd">    problem.solve()</span>
<span class="sd">    # Get the partition results</span>
<span class="sd">    x_values = x.value</span>
<span class="sd">    first_partition = [lst[i] for i in range(n) if x_values[i] &gt;= 0.5]</span>
<span class="sd">    second_partition = [lst[i] for i in range(n) if x_values[i] &lt; 0.5]</span>
<span class="sd">    return problem, (first_partition, second_partition)</span>
<span class="sd"># Example usage</span>
<span class="sd"># lst = [2, 5, 9, 7, 3, 5]</span>
<span class="sd">N = 300</span>
<span class="sd">lst = np.random.randint(0, 31, N)</span>
<span class="sd">lst[-1] = int(lst.sum() * 0.7)</span>
<span class="sd">print(&quot;full set: &quot;, lst)</span>
<span class="sd">problem, (part1, part2) = find_best_partition(lst)</span>
<span class="sd">print(&quot;First partition:&quot;, part1)</span>
<span class="sd">print(&quot;Second partition:&quot;, part2)</span>
<span class="sd">print(&quot;Sum of first partition:&quot;, sum(part1))</span>
<span class="sd">print(&quot;Sum of second partition:&quot;, sum(part2))</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Section 3.1 The Number Partitioning Problem</span>
<span class="sd">Partition a set of numbers into two subsets such that the subset sums are as close to each other as possible.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">dimod</span>
<span class="kn">import</span> <span class="nn">dwave</span>
<span class="kn">from</span> <span class="nn">dwave.system.samplers</span> <span class="kn">import</span> <span class="n">DWaveSampler</span>
<span class="kn">from</span> <span class="nn">dwave.system.composites</span> <span class="kn">import</span> <span class="n">EmbeddingComposite</span>

<span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">split_numbers_list</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
    <span class="n">list1</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">list2</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">include_in_list</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">key</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">include_in_list</span><span class="p">:</span>
            <span class="n">list1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numbers</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">list2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numbers</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">list1</span><span class="p">,</span> <span class="n">list2</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;#&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>

<span class="n">c</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>
<span class="n">c_square</span> <span class="o">=</span> <span class="n">c</span> <span class="o">**</span> <span class="mi">2</span>

<span class="n">linear</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">quadratic</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">offset</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">vartype</span> <span class="o">=</span> <span class="n">dimod</span><span class="o">.</span><span class="n">BINARY</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">numbers</span><span class="p">):</span>
    <span class="n">linear</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span> <span class="o">*</span> <span class="p">(</span><span class="n">value</span> <span class="o">-</span> <span class="n">c</span><span class="p">)</span>
<span class="k">for</span> <span class="n">index1</span><span class="p">,</span> <span class="n">value1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">numbers</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">index2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">index1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">numbers</span><span class="p">)):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">value1</span> <span class="o">*</span> <span class="n">numbers</span><span class="p">[</span><span class="n">index2</span><span class="p">]</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">index1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">index2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">quadratic</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">quadratic</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">idx</span><span class="p">))]</span> <span class="o">=</span> <span class="n">value</span>
<span class="c1"># print linear</span>
<span class="c1"># print quadratic</span>

<span class="c1"># Expected Solution</span>
<span class="c1"># x=(0,0,0,1,1,0,0,1), ie list1=[31,42,10]; list2=[25,7,13,17,21]</span>
<span class="c1"># y=-6889</span>

<span class="n">bqm</span> <span class="o">=</span> <span class="n">dimod</span><span class="o">.</span><span class="n">BinaryQuadraticModel</span><span class="p">(</span><span class="n">linear</span><span class="p">,</span> <span class="n">quadratic</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">vartype</span><span class="p">)</span>

<span class="n">sampler</span> <span class="o">=</span> <span class="n">dimod</span><span class="o">.</span><span class="n">ExactSolver</span><span class="p">()</span>
<span class="n">sample_set</span> <span class="o">=</span> <span class="n">sampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">bqm</span><span class="p">)</span>
<span class="n">sample_set</span> <span class="o">=</span> <span class="n">sample_set</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">print(&quot;Using ExactSolver()&quot;)</span>
<span class="sd">print(sample_set)</span>
<span class="sd">for sample in sample_set.samples():</span>
<span class="sd">    list1, list2 = split_numbers_list(numbers, sample)</span>
<span class="sd">    print(</span>
<span class="sd">        &quot;list1: {}, sum: {}, list2: {}, sum: {}&quot;.format(</span>
<span class="sd">            list1, sum(list1), list2, sum(list2)</span>
<span class="sd">        )</span>
<span class="sd">    )</span>

<span class="sd">sampler = dimod.SimulatedAnnealingSampler()</span>
<span class="sd">sample_set = sampler.sample(bqm)</span>
<span class="sd">sample_set = sample_set.truncate(5)</span>
<span class="sd">print(&quot;Using SimulatedAnnlearingSampler()&quot;)</span>
<span class="sd">print(sample_set)</span>
<span class="sd">for sample in sample_set.samples():</span>
<span class="sd">    list1, list2 = split_numbers_list(numbers, sample)</span>
<span class="sd">    print(</span>
<span class="sd">        &quot;list1: {}, sum: {}, list2: {}, sum: {}&quot;.format(</span>
<span class="sd">            list1, sum(list1), list2, sum(list2)</span>
<span class="sd">        )</span>
<span class="sd">    )</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dimod</span>

<span class="k">def</span> <span class="nf">heuristic_solve</span><span class="p">(</span><span class="n">numlist</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">copy</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">numlist</span><span class="p">)</span>
    <span class="n">list_copy</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">numlist</span><span class="p">))</span>
    <span class="n">list_copy</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">set_AB</span> <span class="o">=</span> <span class="p">([],</span> <span class="p">[])</span>
    <span class="n">ii</span><span class="p">,</span> <span class="n">cc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">list_copy</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">list_copy</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">set_AB</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
        <span class="n">ii</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">ii</span>
        <span class="n">cc</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_copy</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">set_AB</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">list_copy</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>
    <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">cc</span><span class="o">%</span><span class="k">2</span> == 0:
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">list_copy</span>
            <span class="n">set_AB</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
            <span class="n">set_AB</span><span class="p">[</span><span class="mi">1</span><span class="o">-</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">list_copy</span><span class="o">.</span><span class="n">pop</span><span class="p">(),</span> <span class="n">list_copy</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="n">set_AB</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
    <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">set_AB</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">i</span> <span class="ow">in</span> <span class="n">y1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numlist</span><span class="p">])</span>
    <span class="c1"># fix this!</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span>

<span class="c1"># ni = np.array([3, 4, 5, 6, 8, 12, 11, 15])</span>
<span class="c1"># ni = np.array([1,2,3,4,5,6,7,8])</span>

<span class="n">ni</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ni</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ni</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span>
<span class="n">qubofunc</span> <span class="o">=</span> <span class="n">qubo</span><span class="p">(</span><span class="n">ni</span><span class="o">=</span><span class="n">ni</span><span class="p">)</span>

<span class="n">qdict</span> <span class="o">=</span> <span class="p">{(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span> <span class="mi">2</span><span class="o">*</span><span class="n">qubofunc</span><span class="o">.</span><span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">qubofunc</span><span class="o">.</span><span class="n">N</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">qubofunc</span><span class="o">.</span><span class="n">N</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span><span class="o">&gt;</span><span class="n">j</span><span class="p">}</span>
<span class="n">ldict</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">qubofunc</span><span class="o">.</span><span class="n">V</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">qubofunc</span><span class="o">.</span><span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">qubofunc</span><span class="o">.</span><span class="n">N</span><span class="p">)}</span>
<span class="n">constant</span> <span class="o">=</span> <span class="n">qubofunc</span><span class="o">.</span><span class="n">S</span><span class="o">**</span><span class="mi">2</span>

<span class="n">bqm_set</span> <span class="o">=</span> <span class="n">dimod</span><span class="o">.</span><span class="n">BinaryQuadraticModel</span><span class="p">(</span><span class="n">ldict</span><span class="p">,</span> <span class="n">qdict</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">constant</span><span class="p">,</span> <span class="n">vartype</span><span class="o">=</span><span class="n">dimod</span><span class="o">.</span><span class="n">BINARY</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bqm_set</span><span class="o">.</span><span class="n">quadratic</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bqm_set</span><span class="o">.</span><span class="n">linear</span><span class="p">)</span>

<span class="c1"># sampler = dimod.ExactSolver()</span>
<span class="n">sampler</span> <span class="o">=</span> <span class="n">dimod</span><span class="o">.</span><span class="n">samplers</span><span class="o">.</span><span class="n">SimulatedAnnealingSampler</span><span class="p">()</span>
<span class="n">sample_set</span> <span class="o">=</span> <span class="n">sampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">bqm_set</span><span class="p">,</span> <span class="n">num_sweeps</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">sample_set</span> <span class="o">=</span> <span class="n">sample_set</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>

<span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">sample_set</span><span class="o">.</span><span class="n">samples</span><span class="p">():</span>
    <span class="n">xi</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">fi</span> <span class="o">=</span> <span class="n">qubofunc</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>
    <span class="n">ia</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">sample</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">ib</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">sample</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x = </span><span class="si">{</span><span class="n">xi</span><span class="si">}</span><span class="s2">, f(x)=</span><span class="si">{</span><span class="n">fi</span><span class="si">}</span><span class="s2">, set A = </span><span class="si">{</span><span class="n">ni</span><span class="p">[</span><span class="n">ia</span><span class="p">]</span><span class="si">}</span><span class="s2">, set B = </span><span class="si">{</span><span class="n">ni</span><span class="p">[</span><span class="n">ib</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="n">ni</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">heuristic_solve</span><span class="p">(</span><span class="n">ni</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Heuristic result: set A = </span><span class="si">{</span><span class="n">y1</span><span class="si">}</span><span class="s2">, set B = </span><span class="si">{</span><span class="n">y2</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">y1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">y2</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{(0, 1): 3528.0, (2, 1): 2184.0, (2, 0): 2184.0, (3, 1): 3696.0, (3, 0): 3696.0, (3, 2): 2288.0, (4, 1): 2520.0, (4, 0): 2520.0, (4, 2): 1560.0, (4, 3): 2640.0, (5, 1): 2016.0, (5, 0): 2016.0, (5, 2): 1248.0, (5, 3): 2112.0, (5, 4): 1440.0, (6, 1): 504.0, (6, 0): 504.0, (6, 2): 312.0, (6, 3): 528.0, (6, 4): 360.0, (6, 5): 288.0, (7, 1): 2184.0, (7, 0): 2184.0, (7, 2): 1352.0, (7, 3): 2288.0, (7, 4): 1560.0, (7, 5): 1248.0, (7, 6): 312.0, (8, 1): 4032.0, (8, 0): 4032.0, (8, 2): 2496.0, (8, 3): 4224.0, (8, 4): 2880.0, (8, 5): 2304.0, (8, 6): 576.0, (8, 7): 2496.0, (9, 1): 3192.0, (9, 0): 3192.0, (9, 2): 1976.0, (9, 3): 3344.0, (9, 4): 2280.0, (9, 5): 1824.0, (9, 6): 456.0, (9, 7): 1976.0, (9, 8): 3648.0, (10, 1): 2688.0, (10, 0): 2688.0, (10, 2): 1664.0, (10, 3): 2816.0, (10, 4): 1920.0, (10, 5): 1536.0, (10, 6): 384.0, (10, 7): 1664.0, (10, 8): 3072.0, (10, 9): 2432.0, (11, 1): 3192.0, (11, 0): 3192.0, (11, 2): 1976.0, (11, 3): 3344.0, (11, 4): 2280.0, (11, 5): 1824.0, (11, 6): 456.0, (11, 7): 1976.0, (11, 8): 3648.0, (11, 9): 2888.0, (11, 10): 2432.0, (12, 1): 4368.0, (12, 0): 4368.0, (12, 2): 2704.0, (12, 3): 4576.0, (12, 4): 3120.0, (12, 5): 2496.0, (12, 6): 624.0, (12, 7): 2704.0, (12, 8): 4992.0, (12, 9): 3952.0, (12, 10): 3328.0, (12, 11): 3952.0, (13, 1): 1848.0, (13, 0): 1848.0, (13, 2): 1144.0, (13, 3): 1936.0, (13, 4): 1320.0, (13, 5): 1056.0, (13, 6): 264.0, (13, 7): 1144.0, (13, 8): 2112.0, (13, 9): 1672.0, (13, 10): 1408.0, (13, 11): 1672.0, (13, 12): 2288.0, (14, 1): 27888.0, (14, 0): 27888.0, (14, 2): 17264.0, (14, 3): 29216.0, (14, 4): 19920.0, (14, 5): 15936.0, (14, 6): 3984.0, (14, 7): 17264.0, (14, 8): 31872.0, (14, 9): 25232.0, (14, 10): 21248.0, (14, 11): 25232.0, (14, 12): 34528.0, (14, 13): 14608.0}
{1: -31920.0, 0: -31920.0, 2: -20176.0, 3: -33352.0, 4: -23160.0, 5: -18672.0, 6: -4776.0, 7: -20176.0, 8: -36192.0, 9: -29032.0, 10: -24640.0, 11: -29032.0, 12: -39000.0, 13: -17160.0, 14: -156040.0}
x = [0 0 0 1 0 1 0 0 0 0 0 0 0 0 1], f(x)=1, set A = [21 21 13 15  3 13 24 19 16 19 26 11], set B = [ 22  12 166]
x = [1 1 1 1 1 1 1 1 1 1 0 0 1 1 0], f(x)=1, set A = [ 16  19 166], set B = [21 21 13 22 15 12  3 13 24 19 26 11]
x = [1 1 1 1 1 1 0 1 1 1 1 0 1 0 0], f(x)=9, set A = [  3  19  11 166], set B = [21 21 13 22 15 12 13 24 19 16 26]
x = [1 1 1 1 1 1 0 1 1 1 1 0 1 0 0], f(x)=9, set A = [  3  19  11 166], set B = [21 21 13 22 15 12 13 24 19 16 26]
x = [1 1 1 1 1 1 0 1 1 1 1 0 1 0 0], f(x)=9, set A = [  3  19  11 166], set B = [21 21 13 22 15 12 13 24 19 16 26]
x = [1 1 1 1 1 1 1 1 1 1 1 1 0 0 0], f(x)=25, set A = [ 26  11 166], set B = [21 21 13 22 15 12  3 13 24 19 16 19]
x = [0 0 1 0 0 0 1 0 0 0 1 0 0 0 1], f(x)=25, set A = [21 21 22 15 12 13 24 19 19 26 11], set B = [ 13   3  16 166]
x = [1 1 1 1 1 1 1 1 1 1 1 1 0 0 0], f(x)=25, set A = [ 26  11 166], set B = [21 21 13 22 15 12  3 13 24 19 16 19]
x = [1 1 1 1 1 0 1 1 1 1 1 1 0 1 0], f(x)=49, set A = [ 12  26 166], set B = [21 21 13 22 15  3 13 24 19 16 19 11]
x = [1 1 1 1 1 1 1 1 1 1 0 1 0 1 0], f(x)=225, set A = [ 16  26 166], set B = [21 21 13 22 15 12  3 13 24 19 19 11]
[ 21  21  13  22  15  12   3  13  24  19  16  19  26  11 166]
Heuristic result: set A = [3, 166, 12, 24, 13, 21, 16, 19], set B = [11, 26, 13, 22, 15, 21, 19], 21609
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">bqm_set</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">qubofunc</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(144.0, 144)
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./lecture-11"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1">Example 1</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By ICHEC Team
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  Copyright@2024
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>